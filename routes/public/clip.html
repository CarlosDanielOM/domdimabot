<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clip Player</title>
</head>

<body>

    <div id="container"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script>

        const container = document.getElementById('container');

        let channel = window.location.pathname.split('/')[2];
        const socket = io(`/clip/${channel}`);

        const second = 1000;

        socket.on('play-clip', (data) => {
            let duration = Number(data.duration);

            let clipLink = `http://localhost:3000/video/${channel}`;

            const videoPlayer = document.createElement('video');

            const videoSource = document.createElement('source');
            videoSource.setAttribute('src', clipLink);
            videoSource.setAttribute('type', 'video/mp4');
            videoPlayer.appendChild(videoSource);

            videoPlayer.setAttribute('width', '400px');
            videoPlayer.setAttribute('height', '300px');
            videoPlayer.setAttribute('autoplay', 'true');

            container.appendChild(videoPlayer);



            setTimeout(() => {
                videoPlayer.remove();
            }, (second * duration) + (second * 3));
        })
    </script>
</body>

</html>